package game

import "ccInput"
import "entity"



var Name str = "  S  N  A  K  E  "
var NumDirectionRadians i32 = 256 // gives 64 possibilities per quadrant 
var DirectionRadianGrain f32
var AsteroidVelocityGrain f32 = 0.00002
var BulletRadius f32 = 0.015

// FIXME: when classes are useable outside their package of declaration 
type Rect struct {
	Top f32
	Right f32
	Bottom f32
	Left f32
}

// screen 
var Width i32 = 1280
var Height i32 = 720
var ScreenBoundsTop f32
var ScreenBoundsRight f32
var ScreenBoundsBottom f32
var ScreenBoundsLeft f32

// snake 
var MinSnakeExtent f64 = 0.1D
var MaxSnakeExtent f64 = 0.35D
var CurrSnakeExtent f64 = 0.17D
var CurrSnakeAim f64 = 0.0D
var TailRadius f32 = 0.02
var HeadRadius f32 = 0.07


func Init() () {
	DirectionRadianGrain = 2.0 * 3.141592654 / i32.f32(NumDirectionRadians)

	// FIXME: making assumptions about vertical span 
	horizontalScreenSpan := i32.f32(Width) / i32.f32(Height)
	ScreenBoundsTop = 1.0
	ScreenBoundsRight = horizontalScreenSpan
	ScreenBoundsBottom = -1.0
	ScreenBoundsLeft = 0.0 - horizontalScreenSpan

	entity.Init()
	str.print("--- game.Init()")
}


func Update() () {
	ccInput.SetSnakeVelocity()
	entity.Update()
}





var divisor f64 = 1000.0D
func AdjustSnakeAimAndSize(deltaX f64, deltaY f64) () {
	CurrSnakeAim    -= (deltaX / divisor * 2.0D)
	CurrSnakeExtent -= (deltaY / divisor)

	if CurrSnakeExtent > MaxSnakeExtent {
		CurrSnakeExtent = MaxSnakeExtent
	}

	if CurrSnakeExtent < MinSnakeExtent {
		CurrSnakeExtent = MinSnakeExtent
	}

	//str.print(str.concat("CurrSnakeAim: ", f64.str(CurrSnakeAim)))
	//str.print(str.concat("CurrSnakeExtent: ", f64.str(CurrSnakeExtent)))
}


func GetDistance(aX f32, aY f32, bX f32, bY f32) (out f32) {
	xOff := bX - aX
	yOff := bY - aY
	return f32.pow((xOff ** 2.0) + (yOff ** 2.0), 0.5)
}
